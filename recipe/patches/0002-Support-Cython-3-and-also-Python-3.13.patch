From faa488d7ef2d3249ce91373181fdd88321028566 Mon Sep 17 00:00:00 2001
From: J08nY <johny@neuromancer.sk>
Date: Thu, 16 Jan 2025 12:15:33 +0100
Subject: [PATCH 2/2] Support Cython 3 (and also Python 3.13).

---
 pyproject.toml           | 2 +-
 setup.cfg                | 2 +-
 thinc/backends/cblas.pxd | 8 ++++----
 3 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/pyproject.toml b/pyproject.toml
index d74618b5..8fbb0e7d 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -1,7 +1,7 @@
 [build-system]
 requires = [
     "setuptools",
-    "cython>=0.25,<3.0",
+    "cython>=0.25",
     "murmurhash>=1.0.2,<1.1.0",
     "cymem>=2.0.2,<2.1.0",
     "preshed>=3.0.2,<3.1.0",
diff --git a/setup.cfg b/setup.cfg
index 5cc064c6..f56a70f1 100644
--- a/setup.cfg
+++ b/setup.cfg
@@ -28,7 +28,7 @@ zip_safe = false
 include_package_data = true
 python_requires = >=3.9
 setup_requires =
-    cython>=0.25,<3.0
+    cython>=0.25
     numpy
     # We also need our Cython packages here to compile against 
     cymem>=2.0.2,<2.1.0
diff --git a/thinc/backends/cblas.pxd b/thinc/backends/cblas.pxd
index c608d870..6666d916 100644
--- a/thinc/backends/cblas.pxd
+++ b/thinc/backends/cblas.pxd
@@ -2,18 +2,18 @@ from libcpp.memory cimport shared_ptr
 
 ctypedef void (*sgemm_ptr)(bint transA, bint transB, int M, int N, int K,
                            float alpha, const float* A, int lda, const float* B,
-                           int ldb, float beta, float* C, int ldc) nogil
+                           int ldb, float beta, float* C, int ldc) nogil noexcept
 ctypedef void (*dgemm_ptr)(bint transA, bint transB, int M, int N, int K,
                            double alpha, const double* A, int lda, const double* B,
-                           int ldb, double beta, double* C, int ldc) nogil
+                           int ldb, double beta, double* C, int ldc) nogil noexcept
 
 
 ctypedef void (*saxpy_ptr)(int N, float alpha, const float* X, int incX,
-                           float *Y, int incY) nogil
+                           float *Y, int incY) nogil noexcept
 
 
 ctypedef void (*daxpy_ptr)(int N, double alpha, const double* X, int incX,
-                           double *Y, int incY) nogil
+                           double *Y, int incY) nogil noexcept
 
 ctypedef void (*sscal_ptr)(int N, float alpha, float* X, int incX) nogil
 ctypedef void (*dscal_ptr)(int N, double alpha, double* X, int incX) nogil
